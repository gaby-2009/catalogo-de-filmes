<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Filmes - VitrineLab (Simulação)</title>
    
    <style>
        /* CSS GLOBAL E VARIÁVEIS PARA TEMA ESCURO (Minimalista) */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        :root {
            --cor-fundo-site: #000000; /* Preto Total */
            --cor-fundo-header: #000000; 
            --cor-texto: #ffffff; 
            --cor-primaria: #03a9f4; 
            --cor-secundaria: #ff0077; 
            --cor-borda: #444444;
            --cor-input-bg: #1a1a1a; /* Fundo do input levemente cinza escuro */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; 
            background-color: var(--cor-fundo-site);
            color: var(--cor-texto);
        }
        
        /* ------------------------------------
        * Estilos do HEADER (Barra de Navegação)
        * ------------------------------------
        */
        header {
            background-color: var(--cor-fundo-header);
            padding: 10px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }

        .logo {
            font-size: 1.5em;
            font-weight: 300;
            color: var(--cor-texto);
            display: flex;
            align-items: center;
        }
        .logo span {
            font-size: 0.7em;
            font-weight: 600;
            margin-left: 5px;
        }

        .nav-links {
            flex-grow: 1;
            margin-left: 50px;
        }
        .nav-links a {
            color: var(--cor-texto);
            text-decoration: none;
            margin-right: 25px;
            font-size: 1em;
            transition: color 0.3s;
        }
        .nav-links a:hover {
            color: var(--cor-primaria);
        }
        
        /* -------------------------------------- */
        /* SEÇÃO DE BUSCA E FILTROS (Centralizada) */
        /* -------------------------------------- */
        #busca-api-container {
            padding: 80px 40px;
            text-align: center;
        }

        h2.main-title {
            color: var(--cor-texto);
            font-size: 2.2em;
            font-weight: 300;
            margin-bottom: 30px;
            text-transform: uppercase;
        }

        /* Barra de Busca Grande e Centralizada */
        #input-busca-api {
            width: 80%;
            max-width: 800px;
            padding: 15px 20px;
            margin-bottom: 20px;
            border: 1px solid var(--cor-borda);
            background-color: var(--cor-input-bg);
            color: var(--cor-texto);
            border-radius: 4px;
            font-size: 1.2em;
        }
        
        /* Botão de Busca (Oculto no layout minimalista) */
        #btn-buscar-api {
            display: none; 
        }

        #resultado-api {
            margin-top: 20px;
            font-weight: bold;
            color: var(--cor-primaria);
        }

        /* Container dos Filtros Abaixo da Barra */
        .filtro-avancado-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
        }
        .filtro-grupo {
            text-align: left;
            padding-right: 20px;
            border-right: 1px solid var(--cor-borda);
        }
        .filtro-grupo:last-child {
            border-right: none;
        }
        
        /* Estilo dos Dropdowns e Checkboxes */
        .filtro-grupo label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #ccc;
            cursor: pointer;
        }

        .filtro-dropdown {
            padding: 8px 15px;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            background-color: var(--cor-input-bg);
            color: white;
            appearance: none; /* Remove estilo padrão do SO */
            -webkit-appearance: none;
            -moz-appearance: none;
            cursor: pointer;
        }
        
        /* Oculta o filtro de texto local (Não faz sentido neste layout) */
        #busca-filme {
            display: none !important;
        }

        /* -------------------------------------- */
        /* ESTILOS DA GRADE DE FILMES */
        /* -------------------------------------- */
        #lista-filmes {
            margin: 20px 40px; 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); 
            gap: 20px; 
            padding: 0;
        }

        .filme-card {
            display: block; 
            padding: 0; 
            border: none; 
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3); 
            overflow: hidden; 
            text-align: left;
            background-color: var(--cor-input-bg); 
            position: relative; 
            transition: transform 0.2s;
            cursor: pointer;
        }

        .filme-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.7);
        }

        .filme-imagem {
            width: 100%; 
            height: 300px; 
            object-fit: cover;
            border-radius: 0;
        }

        .filme-info {
            padding: 10px 10px 15px 10px;
        }

        .filme-card h3 {
            margin: 5px 0;
            font-size: 1.1em;
            color: var(--cor-texto); 
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis; 
            height: 1.5em; 
        }

        /* Oculta detalhes e botões */
        .filme-info p, .btn-remover, .btn-trailer {
            display: none !important; 
        }
        
        /* NOTA SOBREPOSTA (Como no mockup) */
        .nota-sobreposta {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: var(--cor-input-bg);
            color: var(--cor-secundaria); 
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 1.1em;
            z-index: 10;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
            border: 1px solid var(--cor-secundaria);
        }

        #mensagem-vazia {
            color: #999;
            grid-column: 1 / -1; /* Ocupa toda a largura da grade */
            text-align: center;
            padding: 40px;
        }
        
        .link-container {
            display: none; /* Ocultar o link para o manual neste layout principal */
        }

        /* Responsividade */
        @media (max-width: 768px) {
            header {
                padding: 10px 20px;
                flex-wrap: wrap;
                justify-content: center;
            }
            .nav-links {
                margin: 10px 0;
                order: 3;
                text-align: center;
                flex-basis: 100%;
            }
            #busca-api-container {
                padding: 40px 20px;
            }
            #input-busca-api {
                width: 100%;
            }
            .filtro-avancado-container {
                flex-direction: column;
                gap: 20px;
                padding: 0 20px;
            }
            .filtro-grupo {
                border-right: none;
                border-bottom: 1px solid var(--cor-borda);
                padding-bottom: 10px;
            }
            #lista-filmes {
                margin: 20px;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            .filme-imagem {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">VITRINE<span style="color: var(--cor-secundaria);">FILMES</span></div>
        <nav class="nav-links">
            <a href="#">Sobre</a>
            <a href="#">Filmes</a>
            <a href="#">Assista em Casa</a>
            <a href="#">Sessão Vitrine</a>
            <a href="#">VitrineLab</a>
            <a href="#">Loja</a>
        </nav>
        <div class="search-icon">
            <input type="text" placeholder="Buscar..." style="padding: 5px; border-radius: 4px; background-color: var(--cor-input-bg); border: 1px solid var(--cor-borda); color: white;">
        </div>
    </header>
    
    <div id="busca-api-container">
        <h2 class="main-title">EXPLORE NOSSO CATÁLOGO DE FILMES</h2>
        <input type="text" id="input-busca-api" placeholder="Digite o título do filme (Ex: barbie, The Matrix)" value="" autofocus>
        <button id="btn-buscar-api">Pesquisar</button>
        <p id="resultado-api"></p>

        <div class="filtro-avancado-container">
            <div class="filtro-grupo">
                <label>Filtrar por gênero</label>
                <select class="filtro-dropdown">
                    <option>Qualquer Gênero</option>
                    <option>Ação</option>
                    <option>Comédia</option>
                    <option>Drama</option>
                </select>
            </div>
            
            <div class="filtro-grupo">
                <label>Filtrar por ano</label>
                <select class="filtro-dropdown">
                    <option>Qualquer Ano</option>
                    <option>2020 - 2025</option>
                    <option>2010 - 2019</option>
                </select>
            </div>

            <div class="filtro-grupo">
                <label>Opções</label>
                <label><input type="checkbox"> Assista em casa</label>
                <label><input type="checkbox"> Assista nos Cinemas</label>
            </div>
            
            <div class="filtro-grupo" style="border-right: none;">
                <label>Programas</label>
                <label><input type="checkbox"> Manequim Filmes</label>
                <label><input type="checkbox"> Sessão Vitrine</label>
            </div>
        </div>
    </div>
    
    <hr style="margin-top: 0; opacity: 0.5;"> 
    
    <input type="text" id="busca-filme" placeholder="Filtre os filmes por título (na lista atual)...">
    <div id="lista-filmes">
        <p id="mensagem-vazia" style="display: block;">Digite um termo de busca acima para ver os filmes.</p>
    </div>
    
    <div class="link-container">
        <a href="manual.html">Ir para Cadastro Manual</a>
    </div>

    <script>

    const OMDb_API_KEY = '4c42996f'; 
    const catalogo = []; 

    // CAPTURA DE ELEMENTOS DO DOM
    const listaFilmesContainer = document.getElementById('lista-filmes');
    const mensagemVazia = document.getElementById('mensagem-vazia');
    const inputBuscaLocal = document.getElementById('busca-filme');
    const inputBuscaApi = document.getElementById('input-busca-api');
    const btnBuscarApi = document.getElementById('btn-buscar-api');
    const resultadoApi = document.getElementById('resultado-api');

    // ====================================
    // I. FUNÇÕES AUXILIARES DE RENDERIZAÇÃO
    // ====================================
    
    /**
     * FUNÇÃO DE RENDERIZAÇÃO (Desenha os filmes na grade)
     */
    function renderizarCatalogo(listaFilmes = []) {
        listaFilmesContainer.innerHTML = '';
        
        // No modo busca, não usamos filtro local, apenas a lista fornecida
        const filmesFiltrados = listaFilmes;
        
        if (filmesFiltrados.length === 0) {
            mensagemVazia.textContent = "Nenhum filme encontrado para esta busca.";
            listaFilmesContainer.appendChild(mensagemVazia);
            mensagemVazia.style.display = 'block';
            return;
        } else {
            mensagemVazia.style.display = 'none';
        }

        filmesFiltrados.forEach((filme) => {
            const filmeCard = document.createElement('div');
            filmeCard.classList.add('filme-card');
            
            // Exibe a nota ou "..." se a nota ainda estiver carregando
            const notaTexto = (typeof filme.nota === 'number' && !isNaN(filme.nota) && filme.nota > 0) ? filme.nota.toFixed(1) : '...';
            const notaSobreposta = `<div class="nota-sobreposta">${notaTexto}</div>`;
            
            // Trata URL de imagem não válida (N/A)
            const posterURL = filme.imagemURL && filme.imagemURL !== 'N/A' 
                ? filme.imagemURL 
                : 'https://via.placeholder.com/200x300?text=Sem+Poster';

            filmeCard.innerHTML = `
                ${notaSobreposta}
                <img src="${posterURL}" alt="Poster do filme ${filme.titulo}" class="filme-imagem">
                <div class="filme-info">
                    <h3>${filme.titulo} (${filme.ano || 'N/A'})</h3>
                </div>
            `;
            
            listaFilmesContainer.appendChild(filmeCard);
        });
    }

    // ====================================
    // II. FUNÇÕES DE BUSCA API OMDb (COM BUSCA DETALHADA)
    // ====================================
    
    /**
     * Faz uma busca detalhada por ID na OMDb.
     */
    async function getFilmeDetalhes(imdbID) {
        const url = `https://www.omdbapi.com/?i=${imdbID}&apikey=${OMDb_API_KEY}`;
        const response = await fetch(url);
        const dados = await response.json();
        
        let notaOmdb = null;
        if (dados.imdbRating && dados.imdbRating !== 'N/A') {
            notaOmdb = parseFloat(dados.imdbRating);
        }

        return {
            titulo: dados.Title,
            imagemURL: dados.Poster, 
            ano: parseInt(dados.Year), 
            nota: notaOmdb,
            imdbID: imdbID
        };
    }

    /**
     * Busca filmes na OMDb API por palavra-chave, busca detalhes e renderiza.
     */
    async function buscarFilmeOMDb() {
        const tituloBusca = inputBuscaApi.value.trim();
        resultadoApi.textContent = ''; 
        
        if (!tituloBusca) {
            resultadoApi.textContent = "Digite o título do filme para iniciar a pesquisa.";
            return;
        }

        resultadoApi.textContent = `Buscando por "${tituloBusca}"...`;
        btnBuscarApi.disabled = true;
        inputBuscaApi.disabled = true;
        listaFilmesContainer.innerHTML = ''; 

        try {
            // PASSO 1: Busca principal (por nome, usando ?s=)
            const urlBusca = `https://www.omdbapi.com/?s=${encodeURIComponent(tituloBusca)}&type=movie&apikey=${OMDb_API_KEY}`;
            const responseBusca = await fetch(urlBusca);
            const dadosBusca = await responseBusca.json();

            if (dadosBusca.Response === "True" && dadosBusca.Search) {
                
                const filmesEncontrados = dadosBusca.Search;
                
                // Exibe os cartões imediatamente com a nota '...' para feedback rápido
                const listaCarregando = filmesEncontrados.map(filme => ({
                    titulo: filme.Title,
                    imagemURL: filme.Poster,
                    ano: filme.Year,
                    nota: null // Nota pendente
                }));
                renderizarCatalogo(listaCarregando);
                
                resultadoApi.textContent = `Encontrados ${filmesEncontrados.length} resultados. Carregando notas...`;
                
                // PASSO 2: Cria Promises para buscar os detalhes
                const promisesDetalhes = filmesEncontrados.map(filme => getFilmeDetalhes(filme.imdbID));
                
                // PASSO 3: Executa todas as buscas detalhadas
                const filmesComDetalhes = await Promise.all(promisesDetalhes);

                // PASSO 4: Renderiza com os dados completos
                renderizarCatalogo(filmesComDetalhes);

                resultadoApi.textContent = `✅ Exibindo ${filmesComDetalhes.length} resultados para "${tituloBusca}".`;

            } else {
                renderizarCatalogo([]); 
                resultadoApi.textContent = `❌ Nenhum filme encontrado para "${tituloBusca}".`;
            }
        } catch (error) {
            console.error("Erro ao buscar filmes na OMDb API:", error);
            resultadoApi.textContent = "⚠️ Erro de conexão ou na API.";
            renderizarCatalogo([]);
        } finally {
            btnBuscarApi.disabled = false;
            inputBuscaApi.disabled = false;
        }
    }
    
    
    // ====================================
    // III. EVENT LISTENERS
    // ====================================
    
    // Event listener para o campo de busca (Keypress Enter)
    inputBuscaApi.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
            event.preventDefault(); 
            buscarFilmeOMDb();
        }
    });

    // Event listener para o botão de busca (caso ele fosse visível)
    btnBuscarApi.addEventListener('click', buscarFilmeOMDb);
    
    // Opcional: Adicionar evento para simular a busca ao perder o foco (blur)
    /*
    inputBuscaApi.addEventListener('blur', () => {
        if (inputBuscaApi.value.trim().length > 2) {
            buscarFilmeOMDb();
        }
    });
    */

    // NENHUMA RENDERIZAÇÃO INICIAL (começa vazio, esperando a busca)
    
</script>

</body>
</html>