<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Filmes - Fase 1: Cadastro Manual (DOM Básico)</title>
    
    <link rel="stylesheet" href="style.css"> 
    <style>
        /* Adicionei um estilo básico para a barra de pesquisa ficar organizada */
        #busca-filme {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }
        /* Estilos adicionais para melhor visualização (Recomendado colocar em style.css) */
        .filme-card {
            display: flex;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }
        .filme-imagem {
            width: 100px; /* Tamanho fixo para a imagem */
            height: 150px;
            object-fit: cover;
            margin-right: 15px;
            border-radius: 4px;
        }
        .filme-info {
            flex-grow: 1;
        }
        .nota {
            margin: 5px 0;
        }
        .estrela {
            font-size: 1.2em;
            color: gray;
        }
        .cheia {
            color: gold;
        }
        .metade {
            /* Poderia ser um ícone de meia estrela, mas usei a mesma cor para simplificar */
            color: orange; 
        }
        .vazia {
            color: #ddd;
        }
    </style>
</head>
<body>
    <h1>𝒞𝒶𝓉𝒶́𝓁ℴℊℴ 𝒹ℯ ℱ𝒾𝓁𝓂ℯ𝓈</h1>
    
    <form id="cadastro-filme">
        <h2>Adicionar Novo Filme</h2>
        
        <div>
            <label for="titulo">Título do Filme:</label>
            <input type="text" id="titulo" required>
        </div>

        <div>
            <label for="imagem-url">Imagem do Filme (URL):</label>
            <input type="url" id="imagem-url" placeholder="Cole o link da imagem (URL)" required>
        </div>

        <div>
            <label for="sinopse">Sinopse:</label>
            <textarea id="sinopse" required></textarea>
        </div>

        <div>
            <label for="diretor">Diretor:</label>
            <input type="text" id="diretor" required>
        </div>

        <div>
            <label for="duracao">Duração (minutos):</label>
            <input type="number" id="duracao" min="1" required>
        </div>

        <div>
            <label for="faixa-etaria">Faixa Etária:</label>
            <select id="faixa-etaria" required>
                <option value="">-- Selecione a Faixa --</option>
                <option value="Livre">Livre</option>
                <option value="10">10 anos</option>
                <option value="12">12 anos</option>
                <option value="14">14 anos</option>
                <option value="16">16 anos</option>
                <option value="18">18 anos</option>
            </select>
        </div>

        <div>
            <label for="ano">Ano de Lançamento:</label>
            <input type="number" id="ano" min="1888" max="2099" required>
        </div>

        <div>
            <label for="genero">Gênero:</label>
            <select id="genero" required>
                <option value="">-- Selecione o Gênero --</option>
                <option value="Acao">Ação</option>
                <option value="Comedia">Comédia</option>
                <option value="Drama">Drama</option>
                <option value="Ficcao">Ficção Científica</option>
                <option value="Terror">Terror</option>
                <option value="Documentario">Documentário</option>
                <option value="Outro">Outro</option>
            </select>
        </div>
        
        <div>
            <label for="nota">Nota (0 a 10):</label>
            <input type="number" id="nota" min="0" max="10" step="0.1" required>
        </div>
        
        <button type="submit">Adicionar Filme</button>
    </form>
     
    <hr>

    <h2>ℳ𝒾𝓃𝒽𝒶 𝓁𝒾𝓈𝓉𝒶 𝒹ℯ 𝒻𝒾𝓁𝓂ℯ𝓈</h2>
    
    <input type="text" id="busca-filme" placeholder="🔍 Pesquisar filmes por título...">

    <div id="lista-filmes">
        <p id="mensagem-vazia">Nenhum filme cadastrado ainda.</p>
    </div>

    <script>
        // 1. ARMAZENAMENTO DE DADOS
        const catalogo = [];

        // ------------------------------------
        // FILME DE EXEMPLO ADICIONADO AQUI
        // ------------------------------------
        catalogo.push({
            titulo: "Um Mistério de Cores",
            imagemURL: "https://i.imgur.com/gK9u5lA.png", // Imagem de exemplo
            sinopse: "Um detetive obcecado por cores deve desvendar a verdade por trás de um crime em que a única pista é uma mancha de cor primária em uma tela vazia.",
            diretor: "Ava Violeta",
            duracao: 118, // 1h 58min
            faixaEtaria: "14 anos",
            ano: 2024, 
            genero: "Suspense",
            nota: 8.5,
        });
        
        catalogo.push({
            titulo: "A Viagem no Tempo",
            imagemURL: "https://via.placeholder.com/100x150?text=Viagem", // Outra Imagem de exemplo
            sinopse: "Cientistas descobrem a chave para viajar no tempo, mas a primeira missão tem consequências inesperadas para o futuro da humanidade.",
            diretor: "Dr. Chronos",
            duracao: 145,
            faixaEtaria: "Livre",
            ano: 2023, 
            genero: "Ficção Científica",
            nota: 9.2,
        });


        // 2. CAPTURA DE ELEMENTOS DO DOM (Input e Contêineres)
        const form = document.getElementById('cadastro-filme');
        const listaFilmesContainer = document.getElementById('lista-filmes');
        const mensagemVazia = document.getElementById('mensagem-vazia');
        
        const inputTitulo = document.getElementById('titulo');
        const inputSinopse = document.getElementById('sinopse');
        const inputAno = document.getElementById('ano');
        const selectGenero = document.getElementById('genero');
        const inputNota = document.getElementById('nota');
        
        const inputDiretor = document.getElementById('diretor');
        const inputDuracao = document.getElementById('duracao');
        const selectFaixaEtaria = document.getElementById('faixa-etaria');
        const inputImagemURL = document.getElementById('imagem-url');
        
        // NOVO ELEMENTO: Input de Busca
        const inputBusca = document.getElementById('busca-filme');


        // ------------------------------------
        // FUNÇÃO AUXILIAR: GERAR ESTRELAS
        // ------------------------------------
        function gerarEstrelas(nota) {
            const notaArredondada = Math.round(nota * 2) / 2;
            let estrelasHtml = '';
            
            for (let i = 1; i <= 5; i++) {
                if (i <= notaArredondada) {
                    estrelasHtml += '<span class="estrela cheia">★</span>';
                } else if (i - 0.5 === notaArredondada) {
                    estrelasHtml += '<span class="estrela metade">★</span>';
                } else {
                    estrelasHtml += '<span class="estrela vazia">★</span>';
                }
            }
            estrelasHtml += `<span class="nota-valor"> (${nota.toFixed(1)}/10)</span>`;

            return estrelasHtml;
        }


        // ------------------------------------
        // FUNÇÃO DE REMOÇÃO (Otimizada)
        // ------------------------------------
        function removerFilme(tituloRemover) {
            // Encontra o índice do filme a ser removido pelo título
            const index = catalogo.findIndex(filme => filme.titulo === tituloRemover);
            
            if (index !== -1) {
                catalogo.splice(index, 1);
                renderizarCatalogo(); // Rerenderiza a lista após a remoção
            }
        }

        // Função auxiliar para formatar minutos em H:MM
        function formatarDuracao(minutos) {
            const horas = Math.floor(minutos / 60);
            const mins = minutos % 60;
            return `${horas > 0 ? horas + 'h ' : ''}${mins > 0 ? mins + 'min' : (horas === 0 ? '0min' : '')}`.trim();
        }

        // ------------------------------------
        // FUNÇÃO DE RENDERIZAÇÃO (Desenha o HTML com estrelas)
        // Adicionada lógica de filtro
        // ------------------------------------
        function renderizarCatalogo() {
            listaFilmesContainer.innerHTML = '';
            
            // 1. Aplicar Filtro
            const termoBusca = inputBusca.value.toLowerCase().trim();
            const filmesFiltrados = catalogo.filter(filme => 
                filme.titulo.toLowerCase().includes(termoBusca)
            );
            
            if (filmesFiltrados.length === 0) {
                // Exibe a mensagem de vazio ou de nenhum resultado encontrado
                mensagemVazia.textContent = termoBusca ? 
                    `Nenhum filme encontrado com o título "${termoBusca}".` : 
                    "Nenhum filme cadastrado ainda.";
                    
                listaFilmesContainer.appendChild(mensagemVazia);
                mensagemVazia.style.display = 'block';
                return;
            } else {
                mensagemVazia.style.display = 'none';
            }

            // 2. Renderizar a lista filtrada
            filmesFiltrados.forEach((filme) => {
                const filmeCard = document.createElement('div');
                filmeCard.classList.add('filme-card');
                
                const duracaoFormatada = formatarDuracao(filme.duracao);
                const estrelasHtml = gerarEstrelas(filme.nota); 
                
                filmeCard.innerHTML = `
                    <img src="${filme.imagemURL}" alt="Poster do filme ${filme.titulo}" class="filme-imagem">
                    <div class="filme-info">
                        <h3>${filme.titulo} (${filme.ano})</h3>
                        <p><strong>Diretor:</strong> ${filme.diretor}</p>
                        <p><strong>Gênero:</strong> ${filme.genero} | <strong>Faixa Etária:</strong> ${filme.faixaEtaria}</p>
                        <p><strong>Duração:</strong> ${duracaoFormatada}</p>
                        
                        <p class="nota"><strong>Nota:</strong> ${estrelasHtml}</p>
                        
                        <p><strong>Sinopse:</strong> ${filme.sinopse}</p>
                        <button class="btn-remover">Remover</button>
                    </div>
                `;
                
                const btnRemover = filmeCard.querySelector('.btn-remover');
                // Alterei o manipulador de remoção para usar o título, pois o índice 
                // muda quando a lista é filtrada!
                btnRemover.addEventListener('click', () => {
                    removerFilme(filme.titulo); 
                });

                listaFilmesContainer.appendChild(filmeCard);
            });
        }

        // ------------------------------------
        // EVENTO: BARRA DE PESQUISA (Filtra ao digitar)
        // ------------------------------------
        inputBusca.addEventListener('input', renderizarCatalogo); 

        // ------------------------------------
        // FUNÇÃO DE CADASTRO (Ao enviar o formulário)
        // ------------------------------------
        form.addEventListener('submit', function(event) {
            event.preventDefault();

            // Pega o texto visível das opções selecionadas
            const generoTexto = selectGenero.options[selectGenero.selectedIndex].text;
            const faixaEtariaTexto = selectFaixaEtaria.options[selectFaixaEtaria.selectedIndex].text;

            const novoFilme = {
                titulo: inputTitulo.value,
                imagemURL: inputImagemURL.value, 
                sinopse: inputSinopse.value,
                diretor: inputDiretor.value,
                duracao: Number(inputDuracao.value),
                faixaEtaria: faixaEtariaTexto,
                ano: Number(inputAno.value), 
                genero: generoTexto,
                nota: Number(inputNota.value),
            };

            catalogo.push(novoFilme);
            // Limpa o filtro de busca ao adicionar um novo filme
            inputBusca.value = ''; 
            renderizarCatalogo();
            form.reset();
            inputTitulo.focus(); 
        });
        
        // RENDERIZAÇÃO INICIAL
        renderizarCatalogo();
    </script>
</body>
</html>